#!/bin/bash
docker rm nnv-malware
docker rm nnenum-malware
docker rmi nnv-malware-image
docker rmi nnenum-malware-image
set -e
#
# Matlab docker for NNV experiments
#
NNV_IMAGE_ID="nnv-malware-image"
NNV_CONTAINER_ID="nnv-malware"
docker build -t $NNV_IMAGE_ID -f smoke_test/Dockerfile_nnv_smoke .
docker run -it -v ${PWD}:/home/user/verify_malware --name $NNV_CONTAINER_ID $NNV_IMAGE_ID
#
# remove nnv docker for space
#
docker rm $NNV_CONTAINER_ID
docker rmi $NNV_IMAGE_ID

#
# nnenum docker for NNV experiments
#
NNENUM_IMAGE_ID="nnenum-malware-image"
NNENUM_CONTAINER_ID="nnenum-malware"
docker build -t $NNENUM_IMAGE_ID -f smoke_test/Dockerfile_nnenum_smoke .
docker run -it -v ${PWD}:/home/user/verify_malware --name $NNENUM_CONTAINER_ID $NNENUM_IMAGE_ID

#
# All tests passed
#
echo -e "\n\n**********************************************"
echo "          smoke tests passed.         "
echo -e "**********************************************\n\n"